
# First sample run

## Sample run
The associated dependencies of APP must be installed prior to attempt running the program. The details of these have been provided in [Installation.md](https://github.com/sohamsg90/APP-Alieness-by-Phyletic-Pattern/blob/main/docs/Installation.md). 

## Input
We are using a random genome *Yersinia pestis KIM10+* to perform our sample run . The NCBI accession number is  [NC_004088](https://www.ncbi.nlm.nih.gov/nuccore/NC_004088.1/).

APP requires two input files - 
1. A file with taxonomic IDs of the associated genome
2. A multiFASTA protein sequence file

### Constructing taxonomic ID file

The taxonomic IDs can be generated by using the [`input_file_prepare.pl`](https://github.com/sohamsg90/APP-Alienness-by-Phyletic-Pattern/blob/main/scripts/taxonomy/input_file_prepare.pl) script. An input file with the genome accession number (NCBI) is to be provided like,

`perl scripts/taxonomy/input_file_prepare.pl accession_number.txt`

This generates a file `3.query_speciesID_taxID.txt` with the species ID and taxonomic ID of the genome (from NCBI taxonomy database).

The output of the file looks like this:
| Acc       | speciesid | taxid  |
| --------- | --------- | ------ |
| NC_004088 | 632       | 187410 |

This file is imported by default into the program. A new file has to be generated whenever analyzing a new genome.

### MultiFASTA protein sequence file
APP has the capability to take input either a multiFASTA file or download the entire proteome of the genome of choice. 

**Option 1:**
In the former case, a file must be provided to the program specifying the type of input.

 `perl APP.pl -query example.fasta -f multifasta`

**Option 2:**
Alternatively, the user can supply the genome accession number (e.g. NC_004088) as a command-line input.

`perl APP.pl -query NC_004088 -f accession`

Note that the input type has changed to `accession`. With the help of pre-installed NCBI eutilities, the program  will download the complete proteome accordinly.

***Tips:***

**Option 1** is directed when the user has a limited set of sequences to analyze, belonging to the same genome.

**Option 2** is when the user wants to perform phyletic pattern analysis on an entire genome (proteome) of interest.

## Execution
To run the program, simply type in:

`perl APP.pl -q <query fileName> -t <query taxonomy file> -o <Output fileName> -f <fileType> [Options]`

***Note:*** The main script file, query sequence file and taxonomic ID file must be placed in the same working directory.

### Options

Following set of options are available with the program.

#### required arguments:
-q - multifasta amino acid file or genome acession number (NCBI only).

-t - query specific taxonomic id file.

-o - Output file name to create.

-f - File type as 'multifasta' or 'accession'.

#### optional arguments:

-n - No. of CPU cores to use for performing blast. By default, uses all available cores.

-m - Marker gene enrichment. Default set to 0. Use 1 only when whole genome is analyzed.

-g - Generate circular gene map with alien genes. Default set to 0. Use 1 only when whole genome is analyzed.

-e - turn on Expert option (1; keep temporary and intermediate files). Default set to 0. 

-v - Provide basic progress messages. Default set to 1.

-d - Provide detailed progress messages. Default set to 0.

## Expected space requirements

APP downloads genomes from NCBI ftp server in real-time. Henceforth, depending on the availability of completely sequenced genomes, and the abundance of genomes of the associated taxonomic ranks, the size of the downloaded database will vary, from genome to genome.


## Output analysis
In the default mode, the program provides a genome-wide list of genes (accession numbers) which are deemed horizontally acquired. Additionally, the program also predicts whether the horizontal gene transfer event was recent or ancient.









